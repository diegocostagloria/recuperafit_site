(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[916],{9116:(e,a,s)=>{Promise.resolve().then(s.bind(s,7993))},7993:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>C});var t=s(5155),o=s(2115),r=s(2865),n=s(5702),l=s(6958),i=s(4505),d=s(2423),c=s(1466),m=s(6462),u=s(3831),x=s(7223),p=s(418),b=s(7506),g=s(2160),h=s(6233),y=s(7568);let f={style:{base:{color:"#32325d",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#aab7c4"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}}};function j(e){let{clientSecret:a,totalPrice:s,onPaymentSuccess:r,onPaymentError:n,onProcessing:l}=e,d=(0,g.useStripe)(),c=(0,g.useElements)(),[m,u]=(0,o.useState)("card"),[x,p]=(0,o.useState)(!1),[b,j]=(0,o.useState)({qrCodeUrl:null,pixCopyPaste:null}),N=async e=>{if(e.preventDefault(),l(!0),p(!0),n(""),!d||!c){n("Stripe n\xe3o foi inicializado corretamente."),l(!1),p(!1);return}let s=c.getElement(g.CardElement);if(!s){n("Elemento do cart\xe3o n\xe3o encontrado."),l(!1),p(!1);return}let{error:t,paymentIntent:o}=await d.confirmCardPayment(a,{payment_method:{card:s}});t?n(t.message||"Ocorreu um erro ao processar o pagamento com cart\xe3o."):o&&"succeeded"===o.status?r(o.id):n("O pagamento com cart\xe3o n\xe3o foi bem-sucedido. Status: "+(null==o?void 0:o.status)),l(!1),p(!1)},v=async()=>{l(!0),p(!0),n(""),j({qrCodeUrl:null,pixCopyPaste:null});try{await new Promise(e=>setTimeout(e,1500)),j({qrCodeUrl:"https://www.gstatic.com/webp/gallery/1.webp",pixCopyPaste:"00020126580014br.gov.bcb.pix0136123e4567-e12b-12d1-a456-42665544000053039865802BR5913NOME DO LOJISTA6008CIDADEBR62070503***6304ABCD"})}catch(e){n(e.message||"Falha ao gerar informa\xe7\xf5es do PIX.")}finally{l(!1),p(!1)}};return(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-gray-700 font-medium mb-2",children:"Escolha o M\xe9todo de Pagamento:"}),(0,t.jsxs)("div",{className:"flex space-x-4",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>u("card"),className:"px-4 py-2 rounded-md flex items-center justify-center w-full ".concat("card"===m?"bg-[#1E5F8C] text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:[(0,t.jsx)(h.A,{className:"mr-2",size:20})," Cart\xe3o de Cr\xe9dito/D\xe9bito"]}),(0,t.jsxs)("button",{type:"button",onClick:()=>u("pix"),className:"px-4 py-2 rounded-md flex items-center justify-center w-full ".concat("pix"===m?"bg-[#1E5F8C] text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:[(0,t.jsx)(y.A,{className:"mr-2",size:20})," PIX"]})]})]}),"card"===m&&(0,t.jsxs)("form",{onSubmit:N,children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{htmlFor:"cardNumber",className:"block text-gray-700 font-medium mb-2",children:"Dados do Cart\xe3o"}),(0,t.jsx)(g.CardElement,{id:"cardNumber",options:f,className:"p-3 border border-gray-300 rounded-md"})]}),(0,t.jsxs)("button",{type:"submit",disabled:!d||x,className:"w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-green-400 disabled:opacity-50 flex items-center justify-center",children:[x?(0,t.jsx)(i.A,{className:"animate-spin mr-2"}):null,"Pagar R$ ",s.toFixed(2)," com Cart\xe3o"]})]}),"pix"===m&&(0,t.jsxs)("div",{children:[!b.qrCodeUrl&&!b.pixCopyPaste&&(0,t.jsxs)("button",{type:"button",onClick:v,disabled:x,className:"w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 disabled:opacity-50 flex items-center justify-center",children:[x?(0,t.jsx)(i.A,{className:"animate-spin mr-2"}):null,"Gerar PIX para Pagar R$ ",s.toFixed(2)]}),b.qrCodeUrl&&(0,t.jsxs)("div",{className:"mt-4 p-4 border border-gray-300 rounded-md text-center",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Pague com PIX"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Escaneie o QR Code abaixo com o app do seu banco:"}),(0,t.jsx)("img",{src:b.qrCodeUrl,alt:"PIX QR Code",className:"mx-auto mb-2 max-w-xs"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Ou use o c\xf3digo Copia e Cola:"}),(0,t.jsx)("input",{type:"text",value:b.pixCopyPaste||"",readOnly:!0,className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50 text-sm text-center mb-2",onClick:e=>e.target.select()}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Ap\xf3s o pagamento, a confirma\xe7\xe3o pode levar alguns instantes. Aguarde nesta tela ou verifique seu e-mail."})]})]})]})}var N=s(2818);let v=(0,b.c)(N.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY||"");function C(){let[e,a]=(0,o.useState)([]),[s,b]=(0,o.useState)(!0),[h,y]=(0,o.useState)(null),[f,N]=(0,o.useState)({name:"",email:"",phone:"",cep:"",address:"",neighborhood:"",city:"",state:"",deliveryDate:(0,r.A)(new Date,"yyyy-MM-dd"),notes:""}),[C,E]=(0,o.useState)(""),[w,F]=(0,o.useState)(0),[P,A]=(0,o.useState)(!1),[D,k]=(0,o.useState)(null),[S,_]=(0,o.useState)(null),[q,M]=(0,o.useState)(!1),[R,z]=(0,o.useState)(!1),[I,O]=(0,o.useState)(null),[T,U]=(0,o.useState)(!1);(0,o.useEffect)(()=>{(async()=>{b(!0);try{let e=await fetch("/api/plans-static");if(!e.ok)throw Error("Falha ao carregar planos");let s=await e.json(),t=s.plans||s;if(a(t),t.length>0){let e=t[0];y(e)}}catch(e){console.error("Erro ao carregar planos:",e),k("N\xe3o foi poss\xedvel carregar os planos dispon\xedveis. Por favor, tente novamente mais tarde.")}finally{b(!1)}})()},[]),(0,o.useEffect)(()=>{h&&f.deliveryDate&&X(h,f.deliveryDate)},[h,f.deliveryDate]);let B=async e=>{if(e&&8===e.length){M(!0);try{let a=await fetch("https://viacep.com.br/ws/".concat(e,"/json/"));if(!a.ok)throw Error("CEP n\xe3o encontrado");let s=await a.json();if(s.erro){k("CEP n\xe3o encontrado. Verifique o n\xfamero informado.");return}N(e=>({...e,address:s.logradouro,neighborhood:s.bairro,city:s.localidade,state:s.uf})),k(null)}catch(e){console.error("Erro ao buscar CEP:",e),k("N\xe3o foi poss\xedvel buscar o endere\xe7o pelo CEP. Por favor, preencha manualmente.")}finally{M(!1)}}},X=(e,a)=>{if(e&&a)try{let s=new Date(a+"T00:00:00"),t=(0,n.A)(s,e.duration_days);E((0,r.A)(t,"yyyy-MM-dd")),F(e.price)}catch(e){console.error("Erro ao calcular datas:",e)}},L=e=>{let{name:a,value:s}=e.target;N(e=>({...e,[a]:s})),"cep"===a&&8===s.length&&B(s)},$=async a=>{if(a.preventDefault(),!h){k("Por favor, selecione um plano.");return}if(!f.name||!f.email||!f.phone||!f.cep||!f.address){k("Por favor, preencha todos os campos obrigat\xf3rios.");return}A(!0),k(null),_(null);try{let a=(0,r.A)(new Date(f.deliveryDate),"dd/MM/yyyy",{locale:l.A}),s=C?(0,r.A)(new Date(C),"dd/MM/yyyy",{locale:l.A}):"",t="*Novo Agendamento - RecoveryFit*\n      \n*Plano Escolhido:* ".concat(h.name,"\n*Valor:* R$ ").concat(h.price.toFixed(2),"\n*Dura\xe7\xe3o:* ").concat(h.duration_days," ").concat(1===h.duration_days?"dia":"dias","\n\n*Dados do Cliente:*\n*Nome:* ").concat(f.name,"\n*E-mail:* ").concat(f.email,"\n*Telefone:* ").concat(f.phone,"\n\n*Endere\xe7o de Entrega:*\n").concat(f.address,"\n").concat(f.neighborhood,", ").concat(f.city," - ").concat(f.state,"\n*CEP:* ").concat(f.cep,"\n\n*Datas:*\n*Entrega:* ").concat(a,"\n*Retirada:* ").concat(s,"\n\n").concat(f.notes?"*Observa\xe7\xf5es:* ".concat(f.notes):""),o=encodeURIComponent(t),n="https://wa.me/55".concat("11989288740","?text=").concat(o);window.open(n,"_blank"),_("Agendamento realizado com sucesso! Voc\xea ser\xe1 redirecionado para o WhatsApp para finalizar o atendimento."),N({name:"",email:"",phone:"",cep:"",address:"",neighborhood:"",city:"",state:"",deliveryDate:(0,r.A)(new Date,"yyyy-MM-dd"),notes:""}),y(e.length>0?e[0]:null),window.scrollTo(0,0)}catch(e){console.error("Erro ao processar agendamento:",e),k("N\xe3o foi poss\xedvel completar o agendamento. Por favor, tente novamente.")}finally{A(!1)}};return s?(0,t.jsx)("div",{className:"container mx-auto px-4 py-12 flex justify-center items-center h-screen",children:(0,t.jsx)(i.A,{className:"h-12 w-12 animate-spin text-[#1E5F8C]"})}):(0,t.jsx)("div",{className:"container mx-auto px-4 py-12",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-center mb-2 text-[#1E5F8C]",children:"Agende sua Bota Pneum\xe1tica"}),(0,t.jsx)("p",{className:"text-center text-gray-600 mb-8",children:"Preencha o formul\xe1rio abaixo para agendar o aluguel."}),D&&(0,t.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:D}),S&&(0,t.jsx)("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-6",children:S}),R?I&&v&&(0,t.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6 mb-8",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-800 border-b pb-2",children:"Complete seu Pagamento"}),(0,t.jsx)(g.Elements,{stripe:v,options:{clientSecret:I},children:(0,t.jsx)(j,{clientSecret:I,totalPrice:w,onPaymentSuccess:a=>{_("Agendamento e Pagamento (ID: ".concat(a,") realizados com sucesso! Entraremos em contato.")),z(!1),N({name:"",email:"",phone:"",cep:"",address:"",neighborhood:"",city:"",state:"",deliveryDate:(0,r.A)(new Date,"yyyy-MM-dd"),notes:""}),y(e.length>0?e[0]:null),window.scrollTo(0,0)},onPaymentError:e=>{k("Falha no Pagamento: ".concat(e)),z(!0)},onProcessing:e=>{U(e)}})}),T&&(0,t.jsxs)("div",{className:"flex justify-center items-center mt-4",children:[(0,t.jsx)(i.A,{className:"h-6 w-6 animate-spin text-[#1E5F8C]"}),(0,t.jsx)("span",{className:"ml-2",children:"Processando pagamento..."})]}),(0,t.jsx)("button",{onClick:()=>{z(!1),k(null)},className:"mt-4 text-sm text-gray-600 hover:text-gray-800",disabled:T,children:"Voltar e editar agendamento"})]}):(0,t.jsxs)("form",{onSubmit:$,className:"bg-white shadow-md rounded-lg p-6 mb-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-800 border-b pb-2",children:"Escolha seu Plano"}),0===e.length&&!s&&(0,t.jsx)("p",{children:"Nenhum plano dispon\xedvel no momento."}),e.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{htmlFor:"plan",className:"block text-gray-700 font-medium mb-2",children:"Selecione o Plano"}),(0,t.jsx)("select",{id:"plan",name:"plan",value:(null==h?void 0:h.id)||"",onChange:a=>{let s=parseInt(a.target.value);y(e.find(e=>e.id===s)||null)},className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#1E5F8C]",required:!0,children:e.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name," - ",e.duration_days," ",1===e.duration_days?"dia":"dias"," - R$ ",e.price.toFixed(2)]},e.id))})]}),h&&(0,t.jsxs)("div",{className:"bg-gray-50 p-4 rounded-md",children:[(0,t.jsx)("h3",{className:"font-semibold text-lg mb-2",children:h.name}),h.description&&(0,t.jsx)("p",{className:"text-gray-600 mb-2",children:h.description}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("span",{className:"text-gray-700",children:["Dura\xe7\xe3o: ",h.duration_days," ",1===h.duration_days?"dia":"dias"]}),(0,t.jsxs)("span",{className:"text-[#1E5F8C] font-bold text-xl",children:["R$ ",h.price.toFixed(2)]})]})]})]})]}),(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-800 border-b pb-2",children:"Datas"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"deliveryDate",className:"block text-gray-700 font-medium mb-2",children:[(0,t.jsx)(d.A,{className:"inline-block mr-2",size:18}),"Data de Entrega"]}),(0,t.jsx)("input",{type:"date",id:"deliveryDate",name:"deliveryDate",value:f.deliveryDate,onChange:L,min:(0,r.A)(new Date,"yyyy-MM-dd"),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#1E5F8C]",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"returnDate",className:"block text-gray-700 font-medium mb-2",children:[(0,t.jsx)(d.A,{className:"inline-block mr-2",size:18}),"Data de Retirada"]}),(0,t.jsx)("input",{type:"date",id:"returnDate",name:"returnDate",value:C,className:"w-full px-4 py-2 border border-gray-300 rounded-md bg-gray-100",disabled:!0}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Data calculada automaticamente"})]})]})]}),(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-800 border-b pb-2",children:"Seus Dados"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"name",className:"block text-gray-700 font-medium mb-2",children:[(0,t.jsx)(c.A,{className:"inline-block mr-2",size:18}),"Nome Completo"]}),(0,t.jsx)("input",{type:"text",id:"name",name:"name",value:f.name,onChange:L,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#1E5F8C]",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"email",className:"block text-gray-700 font-medium mb-2",children:[(0,t.jsx)(m.A,{className:"inline-block mr-2",size:18}),"E-mail"]}),(0,t.jsx)("input",{type:"email",id:"email",name:"email",value:f.email,onChange:L,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#1E5F8C]",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"phone",className:"block text-gray-700 font-medium mb-2",children:[(0,t.jsx)(u.A,{className:"inline-block mr-2",size:18}),"Telefone (WhatsApp)"]}),(0,t.jsx)("input",{type:"tel",id:"phone",name:"phone",value:f.phone,onChange:L,placeholder:"(11) 99999-9999",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#1E5F8C]",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"cep",className:"block text-gray-700 font-medium mb-2",children:[(0,t.jsx)(x.A,{className:"inline-block mr-2",size:18}),"CEP"]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"text",id:"cep",name:"cep",value:f.cep,onChange:L,placeholder:"Somente n\xfameros",maxLength:8,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#1E5F8C]",required:!0}),q&&(0,t.jsx)(i.A,{className:"absolute right-3 top-3 h-4 w-4 animate-spin text-[#1E5F8C]"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Digite o CEP para preenchimento autom\xe1tico"})]})]})]}),(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-800 border-b pb-2",children:"Endere\xe7o de Entrega"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"address",className:"block text-gray-700 font-medium mb-2",children:[(0,t.jsx)(p.A,{className:"inline-block mr-2",size:18}),"Endere\xe7o Completo"]}),(0,t.jsx)("input",{type:"text",id:"address",name:"address",value:f.address,onChange:L,placeholder:"Rua, n\xfamero, complemento",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#1E5F8C]",required:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"neighborhood",className:"block text-gray-700 font-medium mb-2",children:"Bairro"}),(0,t.jsx)("input",{type:"text",id:"neighborhood",name:"neighborhood",value:f.neighborhood,onChange:L,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#1E5F8C]",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"city",className:"block text-gray-700 font-medium mb-2",children:"Cidade"}),(0,t.jsx)("input",{type:"text",id:"city",name:"city",value:f.city,onChange:L,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#1E5F8C]",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"state",className:"block text-gray-700 font-medium mb-2",children:"Estado"}),(0,t.jsx)("input",{type:"text",id:"state",name:"state",value:f.state,onChange:L,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#1E5F8C]",required:!0})]})]})]})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{htmlFor:"notes",className:"block text-gray-700 font-medium mb-2",children:"Observa\xe7\xf5es Adicionais"}),(0,t.jsx)("textarea",{id:"notes",name:"notes",value:f.notes,onChange:L,rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#1E5F8C]",placeholder:"Alguma informa\xe7\xe3o extra para a entrega ou sobre o uso?"})]}),(0,t.jsxs)("button",{type:"submit",disabled:P||!h,className:"w-full bg-[#1E5F8C] hover:bg-[#164A6F] text-white font-bold py-3 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-[#1E5F8C] focus:ring-opacity-50 disabled:opacity-50 flex items-center justify-center",children:[P?(0,t.jsx)(i.A,{className:"animate-spin mr-2"}):null,"Enviar Agendamento"]})]})]})})}}},e=>{var a=a=>e(e.s=a);e.O(0,[231,441,517,358],()=>a(9116)),_N_E=e.O()}]);